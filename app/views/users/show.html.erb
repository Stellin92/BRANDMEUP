<div class="user-page">

  <!-- Header profile -->
  <div class="container">
    <div class="user-header">
      <div class="user-avatar">
        <% if @user.photo.attached? %>
          <%= image_tag url_for(@user.photo), alt: @user.username, class: "avatar-img" %>
        <% else %>
          <%= image_tag "blank-profile-picture-973460_1280_q70y1j.png", alt: @user.username, class: "avatar-img" %>
        <% end %>
      </div>

      <div class="user-info">
        <h1 class="username"><%= @user.username %></h1>
        <p class="bio"><%= @user.bio %></p>
        <% if @user.talent.present? %>
          <p class="talent"><strong>Talent:</strong> <%= @user.talent %></p>
        <% end %>
        <% if @user.values.present? %>
          <div class="values">
            <% Array(@user.values).first(3).each do |val| %>
              <span class="tag"><%= val %></span>
            <% end %>
          </div>
        <% end %>

        <div class="user-actions">
          <% if current_user == @user %>
            <%= link_to "Edit Profile", edit_user_path(@user), class: "btn btn-flat" %>
            <%= link_to "New Outfit", "/outfits/new", class: "btn btn-flat" %>
          <% else %>
            <div data-controller="quick-message">
              <a href="#"
                class="btn btn-flat"
                data-action="click->quick-message#toggle">
                Message
              </a>

              <div class="quick-message d-none" data-quick-message-target="form">
                <%= form_with url: messages_path, method: :post, data: { turbo_frame: "inbox", action: "turbo:submit-start->inbox#open" } do %>
                  <%= hidden_field_tag :receiver_id, @user.id %>
                  <textarea name="content" class="form-control mt-2" rows="3" placeholder="Write your first message..." required></textarea>
                  <button class="btn btn-flat mt-2" type="submit">Send</button>
                <% end %>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
  <!-- Outfits -->
  <% if @user.outfits.present? %>
    <div class="container">
      <div class="user-outfits">
        <h2>Outfits</h2>
        <div class="outfit-grid">
          <% @user.outfits.each do |outfit| %>
            <%= render partial: "outfits/card", locals: { outfit: outfit } %>
          <% end %>
        </div>
      </div>
    </div>
    <% else %>
    <div class="banner banner-user d-flex align-items-center">
      <div class="container" style="max-width: 50%;">
          <h2>Your inner identity awaits its first outfit</h2>
          <p>This is where you can express yourself and plan specific outfits all kind of events!</p>
          <%= link_to "I create", "/outfits/new", class: "btn btn-flat" %>
      </div>
    </div>
    <% end %>
  <div class="modal-overlay"
       data-controller="modal"
       data-modal-target="overlay"
       data-action="click->modal#backdrop"
       hidden>
    <turbo-frame id="outfit_modal" data-modal-target="frame"></turbo-frame>
  </div>
</div>
